{
  "properties": {
    "year": {
      "type": "integer",
      "description": "reference year of the flight"
    },
    "month": {
      "type": "integer",
      "description": "reference month of the flight"
    },
    "day_of_month": {
      "type": "integer",
      "description": "day of month of the flight"
    },
    "day_of_week": {
      "type": "integer",
      "description": "day of week of the flight"
    },
    "origin": {
      "type": "string",
      "description": "Iata code for departure airport"
    },
    "destination": {
      "type": "string",
      "description": "Iata code for arrivals airport"
    },
    "distance": {
      "type": "integer",
      "description": "Distance between departure and arrivals airport"
    },
    "distance_group": {
      "type": "integer",
      "description": "Distance interval between departure and arrival airports, every 250 miles"
    },
    "flights": {
      "type": "array",
      "minItems": 1,
      "uniqueItems": true,
      "items": 
        {
          "type": "object",
          "properties": {
            "airline": {
              "type": "string",
              "description": "Iata code for airlines"
            },
            "crs_dep_time": {
              "type": "string",
              "description": "CRS Departure Time (local time of departures)"
            },
            "dep_time": {
              "type": "string",
              "description": "Actual Departure Time (local time). Not required in case of cancelled/diverted flight"
            },
            "dep_delay": {
              "type": "integer",
              "description": "Difference in minutes between scheduled and actual departure time. Early departures show negative numbers. Not required in case of cancelled/diverted flight"
            },
            "dep_delay_group": {
              "type": "integer",
              "description": "Difference in minutes between scheduled and actual departure time. Early departures set to 0. Not required in case of cancelled/diverted flight"
            },
            "crs_arr_time": {
              "type": "string",
              "description": "CRS Arrival Time (local time of arrivals)"
            },
            "arr_time": {
              "type": "string",
              "description": "Actual Arrival Time (local time). Not required in case of cancelled/diverted flight"
            },
            "arr_delay": {
              "type": "integer",
              "description": "Difference in minutes between scheduled and actual arrival time. Early departures show negative numbers. Not required in case of cancelled/diverted flight"
            },
            "arr_delay_group": {
              "type": "integer",
              "description": "Difference in minutes between scheduled and actual arrival time. Early arrivals  set to 0. Not required in case of cancelled/diverted flight"
            },
            "cancelled": {
              "type": "boolean",
              "description": "Cancelled Flight Indicator (1=Yes)"
            },
            "cancellation_code": {
              "type": "string",
              "description": "Specifies The Reason For Cancellation. Required only if cancelled is true"
            },
            "diverted": {
              "type": "boolean",
              "description": "diverted Flight Indicator (1=Yes)"
            },
            "crs_elapsed_time": {
              "type": "integer",
              "description": "CRS Elapsed Time of Flight, in Minutes"
            },
            "actual_elapsed_time": {
              "type": "integer",
              "description": "Real elapsed Time of Flight, in Minutes."
            },
            "air_time": {
              "type": "integer",
              "description": "Flight Time, in Minutes"
            },
            "carrier_delay": {
              "type": "integer",
              "description": "Carrier Delay, in Minutes."
            },
            "weather_delay": {
              "type": "integer",
              "description": "Weather Delay, in Minutes"
            },
            "nas_delay": {
              "type": "integer",
              "description": "National Air System Delay, in Minutes"
            },
            "security_delay": {
              "type": "integer",
              "description": "Security Delay, in Minutes"
            },
            "late_aircraft_delay": {
              "type": "integer",
              "description": "Late Aircraft Delay, in Minutes "
            }
          },
          "required": [
            "airline",
            "crs_dep_time",
            "crs_arr_time",
            "cancelled",
            "diverted",
            "crs_elapsed_time"
          ],
          "allOf": [
            {
              "dependencies": {
                "cancellation_code": {
                  "properties": {
                    "cancelled": {
                      "enum": [
                        true
                      ]
                    }
                  }
                }
              }
            },
            {
              "if": {
                "properties": {
                  "diverted": {
                    "const": true
                  }
                }
              },
              "then": {
                "properties": {
                  "cancelled": {
                    "const": false
                  }
                }
              }
            },
            {
              "if": {
                "properties": {
                  "cancelled": {
                    "const": true
                  }
                }
              },
              "then": {
                "required": [
                  "cancellation_code"
                ]
              }
            },
            {
              "if": {
                "allOf": [
                  {
                    "properties": {
                      "cancelled": {
                        "const": false
                      },
                      "diverted": {
                        "const": false
                      }
                    }
                  }
                ]
              },
              "then": {
                "required": [
                  "dep_time",
                  "dep_delay",
                  "dep_delay_group",
                  "arr_time",
                  "arr_delay",
                  "arr_delay_group",
                  "actual_elapsed_time",
                  "air_time"
                ]
              },
              "else": {
                "properties": {
                  "dep_time": false,
                  "dep_delay": false,
                  "dep_delay_group": false,
                  "arr_time": false,
                  "arr_delay": false,
                  "arr_delay_group": false,
                  "actual_elapsed_time": false,
                  "air_time": false,
                  "carrier_delay": false,
                  "weather_delay": false,
                  "nas_delay": false,
                  "security_delay": false,
                  "late_aircraft_delay": false
                }
              }
            },
            {
              "if": {
                "properties": {
                  "arr_delay": {
                    "minimum": 14,
                    "exclusiveMinimum": true
                  }
                }
              },
              "then": {
                "required": [
                  "late_aircraft_delay",
                  "security_delay",
                  "nas_delay",
                  "weather_delay",
                  "carrier_delay"
                ]
              },
              "else": {
                "properties": {
                  "carrier_delay": false,
                  "weather_delay": false,
                  "nas_delay": false,
                  "security_delay": false,
                  "late_aircraft_delay": false
                }
              }
            }
          ]
        }
      
    }
  },
  "additionalProperties": false,
  "required": [
    "year",
    "month",
    "day_of_month",
    "day_of_week",
    "origin",
    "destination",
    "distance_group",
    "distance"
  ]
}